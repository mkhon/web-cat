<html><head><title>Connection.js</title><link rel="stylesheet" type="text/css" href="../resources/style.css" media="screen"/></head><body><h1>Connection.js</h1><pre class="highlighted"><code>Ext.data.Connection = <b>function</b>(config){
    Ext.apply(<b>this</b>, config);
    <b>this</b>.events = {
        &quot;beforerequest&quot; : true,
        &quot;requestcomplete&quot; : true,
        &quot;requestexception&quot; : true
    };
};

Ext.extend(Ext.data.Connection, Ext.util.Observable, {
    timeout : 30000,
    request : <b>function</b>(options){
        <b>if</b>(this.fireEvent(&quot;beforerequest&quot;, <b>this</b>, options) !== false){
            <b>var</b> p = options.params;
            <b>if</b>(typeof p == &quot;object&quot;){
                p = Ext.urlEncode(Ext.apply(options.params, <b>this</b>.extraParams));
            }
            <b>var</b> cb = {
                success: <b>this</b>.handleResponse,
                failure: <b>this</b>.handleFailure,
                scope: <b>this</b>,
        		argument: {options: options},
        		timeout : <b>this</b>.timeout
            };
            <b>var</b> method = options.method||<b>this</b>.method||(p ? &quot;POST&quot; : &quot;GET&quot;);
            <b>var</b> url = options.url || <b>this</b>.url;
            <b>if</b>(this.autoAbort !== false){
                <b>this</b>.abort();
            }
            <b>if</b>(method == 'GET' &amp;&amp; p){
                url += (url.indexOf('?') != -1 ? '&amp;' : '?') + p;
                p = '';
            }
            <b>this</b>.transId = Ext.lib.Ajax.request(method, url, cb, p);
        }<b>else</b>{
            <b>if</b>(typeof options.callback == &quot;<b>function</b>&quot;){
                options.callback.call(options.scope||window, options, null, null);
            }
        }
    },
    
    isLoading : <b>function</b>(){
        <b>return</b> this.transId ? true : false;  
    },
    
    abort : <b>function</b>(){
        <b>if</b>(this.isLoading()){
            Ext.lib.Ajax.abort(<b>this</b>.transId);
        }
    },
    
    handleResponse : <b>function</b>(response){
        <b>this</b>.transId = false;
        <b>var</b> options = response.argument.options;
        <b>this</b>.fireEvent(&quot;requestcomplete&quot;, <b>this</b>, response, options);
        <b>if</b>(typeof options.callback == &quot;<b>function</b>&quot;){
            options.callback.call(options.scope||window, options, true, response);
        }
    },
    
    handleFailure : <b>function</b>(response, e){
        <b>this</b>.transId = false;
        <b>var</b> options = response.argument.options;
        <b>this</b>.fireEvent(&quot;requestexception&quot;, <b>this</b>, response, options, e);
        <b>if</b>(typeof options.callback == &quot;<b>function</b>&quot;){
            options.callback.call(options.scope||window, options, false, response);
        }
    }
});</code></pre><hr><div style="font-size:10px;text-align:center;color:gray;">yui-ext - Copyright &copy; 2006 Jack Slocum.  |
    Yahoo! UI - Copyright &copy; 2006 Yahoo! Inc.<br />All rights reserved.</div>
    </body></html>