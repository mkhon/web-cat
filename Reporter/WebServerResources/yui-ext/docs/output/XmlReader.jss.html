<html><head><title>XmlReader.js</title><link rel="stylesheet" type="text/css" href="../resources/style.css" media="screen"/></head><body><h1>XmlReader.js</h1><pre class="highlighted"><code>Ext.data.XmlReader = <b>function</b>(meta, recordType){
    Ext.data.XmlReader.superclass.constructor.call(<b>this</b>, meta, recordType);
};
Ext.extend(Ext.data.XmlReader, Ext.data.DataReader, {
    read : <b>function</b>(response){
        <b>var</b> doc = response.responseXML;
        <b>if</b>(!doc) {
            throw {message: &quot;XmlReader.read: XML Document not available&quot;};
        }
        <b>return</b> this.readRecords(doc);
    },
    
    readRecords : <b>function</b>(doc){
        <b>this</b>.xmlData = doc;
        <b>var</b> root = doc.documentElement || doc;
    	<b>var</b> q = Ext.DomQuery;
    	<b>var</b> recordType = <b>this</b>.recordType, fields = recordType.prototype.fields;
    	<b>var</b> sid = <b>this</b>.meta.id;
    	<b>var</b> totalRecords = 0;
    	<b>if</b>(this.meta.totalRecords){
    	    totalRecords = q.selectNumber(<b>this</b>.meta.totalRecords, root, 0);
    	}
    	<b>var</b> records = [];
    	<b>var</b> ns = q.select(<b>this</b>.meta.record, root);
        <b>for</b>(var i = 0, len = ns.length; i &lt; len; i++) {
	        <b>var</b> n = ns[i];
	        <b>var</b> values = {};
	        <b>var</b> id = sid ? q.selectValue(sid, n) : undefined;
	        <b>for</b>(var j = 0, jlen = fields.length; j &lt; jlen; j++){
	            <b>var</b> f = fields.items[j];
                <b>var</b> v = q.selectValue(f.mapping || f.name, n, f.defaultValue);
	            v = f.convert(v);
	            values[f.name] = v;
	        }
	        <b>var</b> record = <b>new</b> recordType(values, id);
	        record.node = n;
	        records[records.length] = record;
	    }
	    
	    <b>return</b> {
	        records : records,
	        totalRecords : totalRecords || records.length
	    };
    }
});</code></pre><hr><div style="font-size:10px;text-align:center;color:gray;">yui-ext - Copyright &copy; 2006 Jack Slocum.  |
    Yahoo! UI - Copyright &copy; 2006 Yahoo! Inc.<br />All rights reserved.</div>
    </body></html>