<html><head><title>Editor.js</title><link rel="stylesheet" type="text/css" href="../resources/style.css" media="screen"/></head><body><h1>Editor.js</h1><pre class="highlighted"><code>Ext.Editor = <b>function</b>(field, config){
    Ext.Editor.superclass.constructor.call(<b>this</b>, config);
    <b>this</b>.field = field;
    <b>this</b>.addEvents({
        &quot;beforestartedit&quot; : true,
        &quot;startedit&quot; : true,
        &quot;beforecomplete&quot; : true,
        &quot;complete&quot; : true,
        &quot;specialkey&quot; : true
    });
};

Ext.extend(Ext.Editor, Ext.Component, {
    value : &quot;&quot;,
    alignment: &quot;c-c?&quot;,
    shadow : &quot;frame&quot;,
    updateEl : false,
    onRender : <b>function</b>(ct){
        <b>this</b>.el = <b>new</b> Ext.Layer({
            shadow: <b>this</b>.shadow,
            cls: &quot;x-editor&quot;,
            parentEl : ct,
            shim : <b>this</b>.shim,
            shadowOffset:3,
            id: <b>this</b>.id
        });
        <b>this</b>.el.setStyle(&quot;overflow&quot;, Ext.isGecko ? &quot;auto&quot; : &quot;hidden&quot;);
        <b>this</b>.field.render(<b>this</b>.el);
        <b>if</b>(Ext.isGecko){
            <b>this</b>.field.el.dom.setAttribute('autocomplete', 'off');
        }
        <b>this</b>.field.show();
        <b>this</b>.field.on(&quot;blur&quot;, <b>this</b>.onBlur, <b>this</b>);
        <b>this</b>.relayEvents(<b>this</b>.field,  [&quot;specialkey&quot;]);
        <b>if</b>(this.field.grow){
            <b>this</b>.field.on(&quot;autosize&quot;, <b>this</b>.el.sync,  <b>this</b>.el, {delay:1});
        }
    },

    startEdit : <b>function</b>(el, value){
        <b>if</b>(this.editing){
            <b>this</b>.completeEdit();
        }
        <b>this</b>.boundEl = Ext.get(el);
        <b>var</b> v = value !== undefined ? value : <b>this</b>.boundEl.dom.innerHTML;
        <b>if</b>(!<b>this</b>.rendered){
            <b>this</b>.render(<b>this</b>.parentEl || document.body);
        }
        <b>if</b>(this.fireEvent(&quot;beforestartedit&quot;, <b>this</b>, <b>this</b>.boundEl, v) === false){
            <b>return</b>;
        }
        <b>this</b>.startValue = v;
        <b>this</b>.field.setValue(v);
        <b>if</b>(this.autoSize){
            <b>var</b> sz = <b>this</b>.boundEl.getSize();
            <b>switch</b>(this.autoSize){
                <b>case</b> &quot;width&quot;:
                <b>this</b>.setSize(sz.width,  &quot;&quot;);
                <b>break</b>;
                <b>case</b> &quot;height&quot;:
                <b>this</b>.setSize(&quot;&quot;,  sz.height);
                <b>break</b>;
                <b>default</b>:
                <b>this</b>.setSize(sz.width,  sz.height);
            }
        }
        <b>this</b>.el.alignTo(<b>this</b>.boundEl, <b>this</b>.alignment);
        <b>this</b>.editing = true;
        <b>if</b>(Ext.QuickTips){
            Ext.QuickTips.disable();
        }
        <b>this</b>.show();
    },

    setSize : <b>function</b>(w, h){
        <b>this</b>.field.setSize(w, h);
        <b>if</b>(this.el){
            <b>this</b>.el.sync();
        }
    },

    realign : <b>function</b>(){
        <b>this</b>.el.alignTo(<b>this</b>.boundEl, <b>this</b>.alignment);
    },

    completeEdit : <b>function</b>(remainVisible){
        <b>if</b>(!<b>this</b>.editing){
            <b>return</b>;
        }
        <b>var</b> v = <b>this</b>.getValue();
        <b>if</b>(this.revertInvalid !== false &amp;&amp; !<b>this</b>.field.isValid()){
            v = <b>this</b>.startValue;
            <b>this</b>.cancelEdit(true);
        }
        <b>if</b>(String(v) == String(<b>this</b>.startValue) &amp;&amp; <b>this</b>.ignoreNoChange){
            <b>this</b>.editing = false;
            <b>this</b>.hide();
        }
        <b>if</b>(this.fireEvent(&quot;beforecomplete&quot;, <b>this</b>, v, <b>this</b>.startValue) !== false){
            <b>this</b>.editing = false;
            <b>if</b>(this.updateEl &amp;&amp; <b>this</b>.boundEl){
                <b>this</b>.boundEl.update(v);
            }
            <b>if</b>(remainVisible !== true){
                <b>this</b>.hide();
            }
            <b>this</b>.fireEvent(&quot;complete&quot;, <b>this</b>, v, <b>this</b>.startValue);
        }
    },

    onShow : <b>function</b>(){
        <b>this</b>.el.show();
        <b>if</b>(this.hideEl !== false){
            <b>this</b>.boundEl.hide();
        }
        <b>this</b>.field.show();
        <b>this</b>.field.focus();
        <b>this</b>.fireEvent(&quot;startedit&quot;, <b>this</b>.boundEl, <b>this</b>.startValue);
    },

    cancelEdit : <b>function</b>(remainVisible){
        <b>if</b>(this.editing){
            <b>this</b>.setValue(<b>this</b>.startValue);
            <b>if</b>(remainVisible !== true){
                <b>this</b>.hide();
            }
        }
    },

    onBlur : <b>function</b>(){
        <b>if</b>(this.allowBlur !== true &amp;&amp; <b>this</b>.editing){
            <b>this</b>.completeEdit();
        }
    },

    onHide : <b>function</b>(){
        <b>if</b>(this.editing){
            <b>this</b>.completeEdit();
            <b>return</b>;
        }
        <b>this</b>.field.blur();
        <b>this</b>.el.hide();
        <b>if</b>(this.hideEl !== false){
            <b>this</b>.boundEl.show();
        }
        <b>if</b>(Ext.QuickTips){
            Ext.QuickTips.enable();
        }
    },

    setValue : <b>function</b>(v){
        <b>this</b>.field.setValue(v);
    },

    getValue : <b>function</b>(){
        <b>return</b> this.field.getValue();
    }
});</code></pre><hr><div style="font-size:10px;text-align:center;color:gray;">yui-ext - Copyright &copy; 2006 Jack Slocum.  |
    Yahoo! UI - Copyright &copy; 2006 Yahoo! Inc.<br />All rights reserved.</div>
    </body></html>