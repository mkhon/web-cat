/*
 * Ext - JS Library 1.0 Alpha 3 - Rev 4
 * Copyright(c) 2006-2007, Jack Slocum.
 * 
 * http://www.extjs.com/license.txt
 */

YAHOO.util.Connect={_msxml_progid:["MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],_http_header:{},_has_http_headers:false,_use_default_post_header:true,_default_post_header:"application/x-www-form-urlencoded",_isFormSubmit:false,_isFileUpload:false,_formNode:null,_sFormData:null,_poll:{},_timeOut:{},_polling_interval:50,_transaction_id:0,setProgId:function(id){this._msxml_progid.unshift(id);},setDefaultPostHeader:function(b){this._use_default_post_header=b;},setPollingInterval:function(i){if(typeof i=="number"&&isFinite(i)){this._polling_interval=i;}},createXhrObject:function(_4){var _5,_6;try{_6=new XMLHttpRequest();_5={conn:_6,tId:_4};}catch(e){for(var i=0;i<this._msxml_progid.length;++i){try{_6=new ActiveXObject(this._msxml_progid[i]);_5={conn:_6,tId:_4};break;}catch(e){}}}finally{return _5;}},getConnectionObject:function(){var o;var _9=this._transaction_id;try{o=this.createXhrObject(_9);if(o){this._transaction_id++;}}catch(e){}finally{return o;}},asyncRequest:function(_a,_b,_c,_d){var o=this.getConnectionObject();if(!o){return null;}else{if(this._isFormSubmit){if(this._isFileUpload){this.uploadFile(o.tId,_c,_b,_d);this.releaseObject(o);return;}if(_a=="GET"){if(this._sFormData.length!=0){_b+=((_b.indexOf("?")==-1)?"?":"&")+this._sFormData;}else{_b+="?"+this._sFormData;}}else{if(_a=="POST"){_d=_d?this._sFormData+"&"+_d:this._sFormData;}}}o.conn.open(_a,_b,true);if(this._isFormSubmit||(_d&&this._use_default_post_header)){this.initHeader("Content-Type",this._default_post_header);if(this._isFormSubmit){this.resetFormState();}}if(this._has_http_headers){this.setHeader(o);}this.handleReadyState(o,_c);o.conn.send(_d||null);return o;}},handleReadyState:function(o,_10){var _11=this;if(_10&&_10.timeout){this._timeOut[o.tId]=window.setTimeout(function(){_11.abort(o,_10,true);},_10.timeout);}this._poll[o.tId]=window.setInterval(function(){if(o.conn&&o.conn.readyState==4){window.clearInterval(_11._poll[o.tId]);delete _11._poll[o.tId];if(_10&&_10.timeout){delete _11._timeOut[o.tId];}_11.handleTransactionResponse(o,_10);}},this._polling_interval);},handleTransactionResponse:function(o,_13,_14){if(!_13){this.releaseObject(o);return;}var _15,_16;try{if(o.conn.status!==undefined&&o.conn.status!=0){_15=o.conn.status;}else{_15=13030;}}catch(e){_15=13030;}if(_15>=200&&_15<300){_16=this.createResponseObject(o,_13.argument);if(_13.success){if(!_13.scope){_13.success(_16);}else{_13.success.apply(_13.scope,[_16]);}}}else{try{switch(_15){case 12002:case 12029:case 12030:case 12031:case 12152:case 13030:_16=this.createExceptionObject(o.tId,_13.argument,(_14?_14:false));if(_13.failure){if(!_13.scope){_13.failure(_16);}else{_13.failure.apply(_13.scope,[_16]);}}break;default:_16=this.createResponseObject(o,_13.argument);if(_13.failure){if(!_13.scope){_13.failure(_16);}else{_13.failure.apply(_13.scope,[_16]);}}}}catch(e){}}this.releaseObject(o);_16=null;},createResponseObject:function(o,_18){var obj={};var _1a={};try{var _1b=o.conn.getAllResponseHeaders();var _1c=_1b.split("\n");for(var i=0;i<_1c.length;i++){var _1e=_1c[i].indexOf(":");if(_1e!=-1){_1a[_1c[i].substring(0,_1e)]=_1c[i].substring(_1e+2);}}}catch(e){}obj.tId=o.tId;obj.status=o.conn.status;obj.statusText=o.conn.statusText;obj.getResponseHeader=_1a;obj.getAllResponseHeaders=_1b;obj.responseText=o.conn.responseText;obj.responseXML=o.conn.responseXML;if(typeof _18!==undefined){obj.argument=_18;}return obj;},createExceptionObject:function(tId,_20,_21){var _22=0;var _23="communication failure";var _24=-1;var _25="transaction aborted";var obj={};obj.tId=tId;if(_21){obj.status=_24;obj.statusText=_25;}else{obj.status=_22;obj.statusText=_23;}if(_20){obj.argument=_20;}return obj;},initHeader:function(lb,_28){if(this._http_header[lb]===undefined){this._http_header[lb]=_28;}else{this._http_header[lb]=_28+","+this._http_header[lb];}this._has_http_headers=true;},setHeader:function(o){for(var _2a in this._http_header){if(this._http_header.hasOwnProperty(_2a)){o.conn.setRequestHeader(_2a,this._http_header[_2a]);}}delete this._http_header;this._http_header={};this._has_http_headers=false;},setForm:function(_2b,_2c,_2d){this.resetFormState();var _2e;if(typeof _2b=="string"){_2e=(document.getElementById(_2b)||document.forms[_2b]);}else{if(typeof _2b=="object"){_2e=_2b;}else{return;}}if(_2c){this.createFrame(_2d?_2d:null);this._isFormSubmit=true;this._isFileUpload=true;this._formNode=_2e;return;}var _2f,_30,_31,_32;var _33=false;for(var i=0;i<_2e.elements.length;i++){_2f=_2e.elements[i];_32=_2e.elements[i].disabled;_30=_2e.elements[i].name;_31=_2e.elements[i].value;if(!_32&&_30){switch(_2f.type){case "select-one":case "select-multiple":for(var j=0;j<_2f.options.length;j++){if(_2f.options[j].selected){if(window.ActiveXObject){this._sFormData+=encodeURIComponent(_30)+"="+encodeURIComponent(_2f.options[j].attributes["value"].specified?_2f.options[j].value:_2f.options[j].text)+"&";}else{this._sFormData+=encodeURIComponent(_30)+"="+encodeURIComponent(_2f.options[j].hasAttribute("value")?_2f.options[j].value:_2f.options[j].text)+"&";}}}break;case "radio":case "checkbox":if(_2f.checked){this._sFormData+=encodeURIComponent(_30)+"="+encodeURIComponent(_31)+"&";}break;case "file":case undefined:case "reset":case "button":break;case "submit":if(_33==false){this._sFormData+=encodeURIComponent(_30)+"="+encodeURIComponent(_31)+"&";_33=true;}break;default:this._sFormData+=encodeURIComponent(_30)+"="+encodeURIComponent(_31)+"&";break;}}}this._isFormSubmit=true;this._sFormData=this._sFormData.substr(0,this._sFormData.length-1);return this._sFormData;},resetFormState:function(){this._isFormSubmit=false;this._isFileUpload=false;this._formNode=null;this._sFormData="";},createFrame:function(_36){var _37="yuiIO"+this._transaction_id;if(window.ActiveXObject){var io=document.createElement("<iframe id=\""+_37+"\" name=\""+_37+"\" />");if(typeof _36=="boolean"){io.src="javascript:false";}else{if(typeof secureURI=="string"){io.src=_36;}}}else{var io=document.createElement("iframe");io.id=_37;io.name=_37;}io.style.position="absolute";io.style.top="-1000px";io.style.left="-1000px";document.body.appendChild(io);},appendPostData:function(_39){var _3a=new Array();var _3b=_39.split("&");for(var i=0;i<_3b.length;i++){var _3d=_3b[i].indexOf("=");if(_3d!=-1){_3a[i]=document.createElement("input");_3a[i].type="hidden";_3a[i].name=_3b[i].substring(0,_3d);_3a[i].value=_3b[i].substring(_3d+1);this._formNode.appendChild(_3a[i]);}}return _3a;},uploadFile:function(id,_3f,uri,_41){var _42="yuiIO"+id;var io=document.getElementById(_42);this._formNode.action=uri;this._formNode.method="POST";this._formNode.target=_42;if(this._formNode.encoding){this._formNode.encoding="multipart/form-data";}else{this._formNode.enctype="multipart/form-data";}if(_41){var _44=this.appendPostData(_41);}this._formNode.submit();if(_44&&_44.length>0){try{for(var i=0;i<_44.length;i++){this._formNode.removeChild(_44[i]);}}catch(e){}}this.resetFormState();var _46=function(){var obj={};obj.tId=id;obj.argument=_3f.argument;try{obj.responseText=io.contentWindow.document.body?io.contentWindow.document.body.innerHTML:null;obj.responseXML=io.contentWindow.document.XMLDocument?io.contentWindow.document.XMLDocument:io.contentWindow.document;}catch(e){}if(_3f.upload){if(!_3f.scope){_3f.upload(obj);}else{_3f.upload.apply(_3f.scope,[obj]);}}if(YAHOO.util.Event){YAHOO.util.Event.removeListener(io,"load",_46);}else{if(window.detachEvent){io.detachEvent("onload",_46);}else{io.removeEventListener("load",_46,false);}}setTimeout(function(){document.body.removeChild(io);},100);};if(YAHOO.util.Event){YAHOO.util.Event.addListener(io,"load",_46);}else{if(window.attachEvent){io.attachEvent("onload",_46);}else{io.addEventListener("load",_46,false);}}},abort:function(o,_49,_4a){if(this.isCallInProgress(o)){o.conn.abort();window.clearInterval(this._poll[o.tId]);delete this._poll[o.tId];if(_4a){delete this._timeOut[o.tId];}this.handleTransactionResponse(o,_49,true);return true;}else{return false;}},isCallInProgress:function(o){if(o.conn){return o.conn.readyState!=4&&o.conn.readyState!=0;}else{return false;}},releaseObject:function(o){o.conn=null;o=null;}};
