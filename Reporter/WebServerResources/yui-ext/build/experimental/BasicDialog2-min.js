/*
 * Ext - JS Library 1.0 Alpha 3 - Rev 4
 * Copyright(c) 2006-2007, Jack Slocum.
 * 
 * http://www.extjs.com/license.txt
 */

Ext.BasicDialog=function(el,_2){_2=_2||{};var dh=Ext.DomHelper;var lc={shadow:_2.shadow,shim:_2.shim!=false,constrain:_2.constraintoviewport!==false};var _5=false;if(_2.autoCreate){var o=typeof _2.autoCreate=="object"?_2.autoCreate:{tag:"div"};o.id=(_2.autoCreate.id||el)||Ext.id();lc.dh=o;}else{_5=el;}var el=new Ext.layer(lc,_5);this.el=el;this.id=el.id;el.addClass("x-dlg");Ext.apply(this,_2);this.proxy=el.createProxy("x-dlg-proxy");this.proxy.hide=this.hideAction;this.proxy.setOpacity(0.5);this.proxy.hide();if(_2.width){el.setWidth(_2.width);}if(_2.height){el.setHeight(_2.height);}this.size=el.getSize();if(typeof _2.x!="undefined"&&typeof _2.y!="undefined"){this.xy=[_2.x,_2.y];}else{this.xy=el.getCenterXY(true);}this.header=el.child("/.x-dlg-hd");this.body=el.child("/.x-dlg-bd");this.footer=el.child("/.x-dlg-ft");if(!this.header){this.header=el.createChild({tag:"div",cls:"x-dlg-hd"},this.body?this.body.dom:null);}if(!this.body){this.body=el.createChild({tag:"div",cls:"x-dlg-bd"});}if(this.title){this.header.update(this.title);}this.focusEl=el.createChild({tag:"a",href:"#",cls:"x-dlg-focus",tabIndex:"-1"});this.focusEl.swallowEvent("click",true);this.header.wrap({cls:"x-dlg-hd-right"}).wrap({cls:"x-dlg-hd-left"},true);this.bwrap=this.body.wrap({tag:"div",cls:"x-dlg-dlg-body"});if(this.footer){this.bwrap.dom.appendChild(this.footer.dom);}this.bg=this.el.createChild({tag:"div",cls:"x-dlg-bg",html:"<div class=\"x-dlg-bg-left\"><div class=\"x-dlg-bg-right\"><div class=\"x-dlg-bg-center\">&#160;</div></div></div>"});this.centerBg=this.bg.child("div.x-dlg-bg-center");Ext.get(this.bg.dom.firstChild.firstChild.firstChild);if(this.autoScroll!==false&&!this.autoTabs){this.body.setStyle("overflow","auto");}if(this.closable!==false){el.addClass("x-dlg-closable");this.close=el.createChild({tag:"div",cls:"x-dlg-close"});this.close.on("click",this.closeClick,this);this.close.addClassOnOver("x-dlg-close-over");}if(this.resizable!==false){el.addClass("x-dlg-resizable");this.resizer=new Ext.Resizable(el,{minWidth:this.minWidth||80,minHeight:this.minHeight||80,handles:this.resizeHandles||"all",pinned:true});this.resizer.on("beforeresize",this.beforeResize,this);this.resizer.on("resize",this.onResize,this);}if(this.draggable!==false){el.addClass("x-dlg-draggable");if(!this.proxyDrag){var dd=new Ext.dd.DD(el.dom.id,"WindowDrag");}else{var dd=new Ext.dd.DDProxy(el.dom.id,"WindowDrag",{dragElId:this.proxy.id});}dd.setHandleElId(this.header.id);dd.endDrag=this.endMove.createDelegate(this);dd.startDrag=this.startMove.createDelegate(this);dd.onDrag=this.onDrag.createDelegate(this);this.dd=dd;}if(this.modal){el.addClass("x-dlg-modal");this.mask=dh.append(document.body,{tag:"div",cls:"x-dlg-mask"},true);this.mask.enableDisplayMode("block");this.mask.hide();}if(this.autoTabs){this.initTabs();}this.syncBodyHeight();this.events={"keydown":true,"move":true,"resize":true,"beforehide":true,"hide":true,"beforeshow":true,"show":true};el.on("keydown",this.onKeyDown,this);el.on("mousedown",this.toFront,this);Ext.EventManager.onWindowResize(this.adjustViewport,this,true);this.el.hide();Ext.DialogManager.register(this);};Ext.extend(Ext.BasicDialog,Ext.util.Observable,{shadowOffset:3,minHeight:80,minWidth:200,minButtonWidth:75,defaultButton:null,buttonAlign:"right",setTitle:function(_8){this.header.update(_8);return this;},closeClick:function(){this.hide();},initTabs:function(){var _9=this.getTabs();while(_9.getTab(0)){_9.removeTab(0);}var _a=YAHOO.util.Dom.getElementsByClassName("x-dlg-tab",this.tabTag||"div",this.el.dom);if(_a.length>0){for(var i=0,_c=_a.length;i<_c;i++){var _d=_a[i];_9.addTab(Ext.id(_d),_d.title);_d.title="";}_9.activate(0);}return _9;},beforeResize:function(){this.resizer.minHeight=Math.max(this.minHeight,this.getHeaderFooterHeight(true)+40);},onResize:function(){this.refreshSize();this.syncBodyHeight();this.adjustAssets();this.fireEvent("resize",this,this.size.width,this.size.height);},onKeyDown:function(e){if(this.isVisible()){this.fireEvent("keydown",this,e);}},resizeTo:function(_f,_10){this.el.setSize(_f,_10);this.size={width:_f,height:_10};this.syncBodyHeight();if(this.fixedcenter){this.center();}if(this.isVisible()){this.constrainXY();this.adjustAssets();}this.fireEvent("resize",this,_f,_10);return this;},setContentSize:function(w,h){h+=this.getHeaderFooterHeight()+this.body.getMargins("tb");w+=this.body.getMargins("lr")+this.bwrap.getMargins("lr")+this.centerBg.getPadding("lr");h+=this.body.getPadding("tb")+this.bwrap.getBorderWidth("tb")+this.body.getBorderWidth("tb")+this.el.getBorderWidth("tb");w+=this.body.getPadding("lr")+this.bwrap.getBorderWidth("lr")+this.body.getBorderWidth("lr")+this.bwrap.getPadding("lr")+this.el.getBorderWidth("lr");if(this.tabs){h+=this.tabs.stripWrap.getHeight()+this.tabs.bodyEl.getMargins("tb")+this.tabs.bodyEl.getPadding("tb");w+=this.tabs.bodyEl.getMargins("lr")+this.tabs.bodyEl.getPadding("lr");}this.resizeTo(w,h);return this;},addKeyListener:function(key,fn,_15){var _16,_17,_18,alt;if(typeof key=="object"&&!(key instanceof Array)){_16=key["key"];_17=key["shift"];_18=key["ctrl"];alt=key["alt"];}else{_16=key;}var _1a=function(dlg,e){if((!_17||e.shiftKey)&&(!_18||e.ctrlKey)&&(!alt||e.altKey)){var k=e.getKey();if(_16 instanceof Array){for(var i=0,len=_16.length;i<len;i++){if(_16[i]==k){fn.call(_15||window,dlg,k,e);return;}}}else{if(k==_16){fn.call(_15||window,dlg,k,e);}}}};this.on("keydown",_1a);return this;},getTabs:function(){if(!this.tabs){this.el.addClass("x-dlg-auto-tabs");this.body.addClass(this.tabPosition=="bottom"?"x-tabs-bottom":"x-tabs-top");this.tabs=new Ext.TabPanel(this.body.dom,this.tabPosition=="bottom");}return this.tabs;},addButton:function(_20,_21,_22){var dh=Ext.DomHelper;if(!this.footer){this.footer=dh.append(this.bwrap.dom,{tag:"div",cls:"x-dlg-ft"},true);}if(!this.btnContainer){var tb=this.footer.createChild({tag:"div",cls:"x-dlg-btns x-dlg-btns-"+this.buttonAlign,html:"<table cellspacing=\"0\"><tbody><tr></tr></tbody></table>"});this.btnContainer=tb.dom.firstChild.firstChild.firstChild;}var _25={handler:_21,scope:_22,minWidth:this.minButtonWidth};if(typeof _20=="string"){_25.text=_20;}else{_25.dhconfig=_20;}var btn=new Ext.Button(this.btnContainer.appendChild(document.createElement("td")),_25);this.syncBodyHeight();if(!this.buttons){this.buttons=[];}this.buttons.push(btn);return btn;},setDefaultButton:function(btn){this.defaultButton=btn;return this;},getHeaderFooterHeight:function(_28){var _29=0;if(this.header){_29+=this.header.getHeight();}if(this.footer){var fm=this.footer.getMargins();_29+=(this.footer.getHeight()+fm.top+fm.bottom);}_29+=this.bwrap.getPadding("tb")+this.bwrap.getBorderWidth("tb");_29+=this.centerBg.getPadding("tb");return _29;},syncBodyHeight:function(){var _2b=this.size.height-this.getHeaderFooterHeight(false);this.body.setHeight(_2b-this.body.getMargins("tb"));if(this.tabs){this.tabs.syncHeight();}var hh=this.header.getHeight();var h=this.size.height-hh;this.centerBg.setHeight(h);this.bwrap.setLeftTop(this.centerBg.getPadding("l"),hh+this.centerBg.getPadding("t"));this.bwrap.setHeight(h-this.centerBg.getPadding("tb"));this.bwrap.setWidth(this.el.getWidth(true)-this.centerBg.getPadding("lr"));this.body.setWidth(this.bwrap.getWidth(true));},restoreState:function(){var box=Ext.state.Manager.get(this.stateId||(this.el.id+"-state"));if(box&&box.width){this.xy=[box.x,box.y];this.resizeTo(box.width,box.height);}return this;},beforeShow:function(){if(this.fixedcenter){this.xy=this.el.getCenterXY(true);}if(this.modal){YAHOO.util.Dom.addClass(document.body,"x-masked");this.mask.setSize(Ext.lib.Dom.getViewWidth(true),Ext.lib.Dom.getViewHeight(true));this.mask.show();}this.constrainXY();},animShow:function(){var b=Ext.get(this.animateTarget,true).getBox();this.proxy.setSize(b.width,b.height);this.proxy.setLocation(b.x,b.y);this.proxy.show();this.proxy.setBounds(this.xy[0],this.xy[1],this.size.width,this.size.height,true,0.35,this.showEl.createDelegate(this));},show:function(_30){if(this.fireEvent("beforeshow",this)===false){return;}if(this.syncHeightBeforeShow){this.syncBodyHeight();}this.animateTarget=_30||this.animateTarget;if(!this.el.isVisible()){this.beforeShow();if(this.animateTarget){this.animShow();}else{this.showEl();}}return this;},showEl:function(){this.proxy.hide();this.el.setXY(this.xy);this.el.show();this.adjustAssets(true);this.toFront();this.focus();this.fireEvent("show",this);},focus:function(){if(this.defaultButton){this.defaultButton.focus();}else{this.focusEl.focus();}},constrainXY:function(){if(this.constraintoviewport!==false){if(!this.viewSize){if(this.container){var s=this.container.getSize();this.viewSize=[s.width,s.height];}else{this.viewSize=[Ext.lib.Dom.getViewWidth(),Ext.lib.Dom.getViewHeight()];}}var x=this.xy[0],y=this.xy[1];var w=this.size.width,h=this.size.height;var vw=this.viewSize[0],vh=this.viewSize[1];var _38=false;if(x+w>vw){x=vw-w;_38=true;}if(y+h>vh){y=vh-h;_38=true;}if(x<0){x=0;_38=true;}if(y<0){y=0;_38=true;}if(_38){this.xy=[x,y];if(this.isVisible()){this.el.setLocation(x,y);this.adjustAssets();}}}},onDrag:function(){if(!this.proxyDrag){this.xy=this.el.getXY();this.adjustAssets();}},adjustAssets:function(_39){var x=this.xy[0],y=this.xy[1];var w=this.size.width,h=this.size.height;if(_39===true){if(this.shadow){this.shadow.show();}if(this.shim){this.shim.show();}}if(this.shadow&&this.shadow.isVisible()){this.shadow.setBounds(x+this.shadowOffset,y+this.shadowOffset,w,h);}if(this.shim&&this.shim.isVisible()){this.shim.setBounds(x,y,w,h);}},adjustViewport:function(w,h){if(!w||!h){w=Ext.lib.Dom.getViewWidth();h=Ext.lib.Dom.getViewHeight();}this.viewSize=[w,h];if(this.modal&&this.mask.isVisible()){this.mask.setSize(w,h);this.mask.setSize(Ext.lib.Dom.getViewWidth(true),Ext.lib.Dom.getViewHeight(true));}if(this.isVisible()){this.constrainXY();}},destroy:function(_40){Ext.EventManager.removeResizeListener(this.adjustViewport,this);if(this.tabs){this.tabs.destroy(_40);}if(this.shim){this.shim.remove();}if(this.shadow){this.shadow.remove();}if(this.proxy){this.proxy.remove();}if(this.resizer){this.resizer.destroy();}if(this.close){this.close.removeAllListeners();this.close.remove();}if(this.mask){this.mask.remove();}if(this.dd){this.dd.unreg();}if(this.buttons){for(var i=0,len=this.buttons.length;i<len;i++){this.buttons[i].destroy();}}this.el.removeAllListeners();if(_40===true){this.el.update("");this.el.remove();}Ext.DialogManager.unregister(this);},startMove:function(){if(this.proxyDrag){this.proxy.show();}if(this.constraintoviewport!==false){this.dd.constrainTo(document.body,{right:this.shadowOffset,bottom:this.shadowOffset});}},endMove:function(){if(!this.proxyDrag){Ext.dd.DD.prototype.endDrag.apply(this.dd,arguments);}else{Ext.dd.DDProxy.prototype.endDrag.apply(this.dd,arguments);this.proxy.hide();}this.refreshSize();this.adjustAssets();this.fireEvent("move",this,this.xy[0],this.xy[1]);},toFront:function(){Ext.DialogManager.bringToFront(this);return this;},toBack:function(){Ext.DialogManager.sendToBack(this);return this;},center:function(){var xy=this.el.getCenterXY(true);this.moveTo(xy[0],xy[1]);return this;},moveTo:function(x,y){this.xy=[x,y];if(this.isVisible()){this.el.setXY(this.xy);this.adjustAssets();}return this;},isVisible:function(){return this.el.isVisible();},animHide:function(_46){var b=Ext.get(this.animateTarget,true).getBox();this.proxy.show();this.proxy.setBounds(this.xy[0],this.xy[1],this.size.width,this.size.height);this.el.hide();this.proxy.setBounds(b.x,b.y,b.width,b.height,true,0.35,this.hideEl.createDelegate(this,[_46]));},hide:function(_48){if(this.fireEvent("beforehide",this)===false){return;}if(this.shadow){this.shadow.hide();}if(this.shim){this.shim.hide();}if(this.animateTarget){this.animHide(_48);}else{this.el.hide();this.hideEl(_48);}return this;},hideEl:function(_49){this.proxy.hide();if(this.modal){this.mask.hide();YAHOO.util.Dom.removeClass(document.body,"x-masked");}this.fireEvent("hide",this);if(typeof _49=="function"){_49();}},hideAction:function(){this.setLeft("-10000px");this.setTop("-10000px");this.setStyle("visibility","hidden");},refreshSize:function(){this.size=this.el.getSize();this.xy=this.el.getXY();Ext.state.Manager.set(this.stateId||this.el.id+"-state",this.el.getBox());},setZIndex:function(_4a){if(this.modal){this.mask.setStyle("z-index",_4a);}if(this.shim){this.shim.setStyle("z-index",++_4a);}if(this.shadow){this.shadow.setStyle("z-index",++_4a);}this.el.setStyle("z-index",++_4a);if(this.proxy){this.proxy.setStyle("z-index",++_4a);}if(this.resizer){this.resizer.proxy.setStyle("z-index",++_4a);}this.lastZIndex=_4a;},getEl:function(){return this.el;}});Ext.DialogManager=function(){var _4b={};var _4c=[];var _4d=null;var _4e=function(d1,d2){return (!d1._lastAccess||d1._lastAccess<d2._lastAccess)?-1:1;};var _51=function(){_4c.sort(_4e);var _52=Ext.DialogManager.zseed;for(var i=0,len=_4c.length;i<len;i++){if(_4c[i]){_4c[i].setZIndex(_52+(i*10));}}};return {zseed:10000,register:function(dlg){_4b[dlg.id]=dlg;_4c.push(dlg);},unregister:function(dlg){delete _4b[dlg.id];if(!_4c.indexOf){for(var i=0,len=_4c.length;i<len;i++){_4c.splice(i,1);return;}}else{var i=_4c.indexOf(dlg);if(i!=-1){_4c.splice(i,1);}}},get:function(id){return typeof id=="object"?id:_4b[id];},bringToFront:function(dlg){dlg=this.get(dlg);if(dlg!=_4d){_4d=dlg;dlg._lastAccess=new Date().getTime();_51();}return dlg;},sendToBack:function(dlg){dlg=this.get(dlg);dlg._lastAccess=-(new Date().getTime());_51();return dlg;}};}();Ext.LayoutDialog=function(el,_5d){_5d.autoTabs=false;Ext.LayoutDialog.superclass.constructor.call(this,el,_5d);this.body.setStyle({overflow:"hidden",position:"relative"});this.layout=new Ext.BorderLayout(this.body.dom,_5d);this.layout.monitorWindowResize=false;this.el.addClass("x-dlg-auto-layout");this.center=Ext.BasicDialog.prototype.center;this.on("show",this.layout.layout,this.layout,true);};Ext.extend(Ext.LayoutDialog,Ext.BasicDialog,{endUpdate:function(){this.layout.endUpdate();},beginUpdate:function(){this.layout.beginUpdate();},getLayout:function(){return this.layout;},syncBodyHeight:function(){Ext.LayoutDialog.superclass.syncBodyHeight.call(this);if(this.layout){this.layout.layout();}}});
